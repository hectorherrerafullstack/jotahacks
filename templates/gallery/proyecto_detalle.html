{% extends "base.html" %}
{% load static %}

{% block title %}{{ proyecto.titulo }} | Caso de estudio{% endblock %}

{% block extra_head %}
<meta name="description" content="{{ proyecto.resumen|default:'Caso de estudio' }}"/>
<script type="application/ld+json">{
  "@context":"https://schema.org",
  "@type":"CaseStudy",
  "name":"{{ proyecto.titulo|escapejs }}",
  "description":"{{ proyecto.resumen|default:proyecto.titulo|escapejs }}",
  "author":{"@type":"Organization","name":"Mi Web"},
  "about":"Inteligencia Artificial aplicada a operaciones",
  "url":"",
  "datePublished":"{{ proyecto.fecha_publicacion|date:'Y-m-d' }}"
}</script>
<script type="application/ld+json">{
  "@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[
    {"@type":"ListItem","position":1,"name":"Inicio","item":"{% url 'home' %}"},
    {"@type":"ListItem","position":2,"name":"Proyectos","item":"{% url 'proyectos_index' %}"},
    {"@type":"ListItem","position":3,"name":"{{ proyecto.titulo|escapejs }}","item":""}
  ]}
</script>
{% endblock %}

{% block content %}
<article class="max-w-4xl mx-auto px-4 py-12">
  <nav class="text-sm mb-4"><a href="{% url 'proyectos_index' %}" class="underline">‚Üê Volver a proyectos</a></nav>
  <header>
    <h1 class="text-4xl font-extrabold">{{ proyecto.titulo }}</h1>
    <p class="mt-2 opacity-80">{{ proyecto.resumen }}</p>
    {% if proyecto.cliente_logo_url %}
    <img src="{{ proyecto.cliente_logo_url }}" alt="Logo cliente" class="mt-4 h-10">
    {% endif %}
  </header>

  <section class="mt-8 space-y-6">
    <div>
      <h2 class="text-2xl font-bold">Reto</h2>
      <div class="mt-2 prose max-w-none">{{ proyecto.reto|safe }}</div>
    </div>
    <div>
      <h2 class="text-2xl font-bold">Enfoque</h2>
      <div class="mt-2 prose max-w-none">{{ proyecto.enfoque|safe }}</div>
    </div>
    <div>
      <h2 class="text-2xl font-bold">Resultado</h2>
      <ul class="mt-2 grid sm:grid-cols-2 gap-3">
        {% for k in proyecto.kpis %}
          <li class="p-4 rounded-xl border bg-white"><span class="font-semibold">{{ k.label }}:</span> {{ k.value }}</li>
        {% endfor %}
      </ul>
    </div>
    <div>
      <h2 class="text-2xl font-bold">Stack</h2>
      <div class="mt-2 flex gap-2 flex-wrap">{% for s in proyecto.stack %}<span class="px-2 py-1 rounded-full bg-gray-100 border text-sm">{{ s }}</span>{% endfor %}</div>
    </div>
    {% if proyecto.video_url %}
    <div>
      <h2 class="text-2xl font-bold">Demo / Video</h2>
      <div class="mt-2 aspect-video">
        <iframe src="{{ proyecto.video_url }}" title="Demo" loading="lazy" class="w-full h-full rounded-xl border"></iframe>
      </div>
    </div>
    {% endif %}
  </section>

  <footer class="mt-10">
    <a href="{% url 'contacto' %}" class="btn btn-primary">Quiero evaluar algo similar</a>
    {% if proyecto.demo_slug %}
      <a href="{% url 'app_live' proyecto.demo_slug %}" class="btn btn-secondary ml-2">Probar demo relacionada</a>
    {% endif %}
  </footer>
</article>
{% endblock %}
